<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="google" content="notranslate">
  <title>IPO Details</title>
  <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      user-select: none;
      -webkit-user-select: none;
    }

    button:focus:not(:focus-visible) {
      outline: none;
    }


    .tab-titles {
      display: flex;
      justify-content: space-around;
      margin-bottom: 10px;
      position: relative;
    }

    .tab-container {
      position: relative;
      /* Position relative for the indicator */
      display: flex;
      /* Align tabs in a row */
    }

    .tab {
      text-align: center;
      cursor: pointer;
      color: rgb(31, 87, 209);
      padding: 15px;
      padding-left: 5px;
      padding-right: 5px;
      transition: color 0.3s ease-in-out;
      /* Smooth color transition */
    }

    .active-tab {
      border-bottom: 2px solid rgb(31, 87, 209);
      transition: left 2s ease-in-out;
      font-weight: bold;
    }

    .indicator {
      position: absolute;
      bottom: 0;
      left: 0;
      height: 2px;
      width: 100px;
      background-color: rgb(4, 65, 197);
      transition: left 2s ease-in-out;
    }

    input[type="radio"] {
      display: none;
    }

    .tab-content .content {
      display: none;
    }

    #tab1:checked~.tab-titles~.tab-content #content1,
    #tab2:checked~.tab-titles~.tab-content #content2 {
      display: block;
    }

    .tab-titles {
      position: relative;
      display: flex;
      margin-bottom: 10px;
    }

    .tab-titles:before {
      content: "";
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 20%;
      transform: translateX(-50%);
      /* Center the indicator */
      /* Default width for larger screens */
      height: 2px;
      background-color: rgb(4, 65, 197);
      transition: left 0.3s ease-in-out;
    }



    .toggle-btn {
      @apply rounded-md px-2.5 py-1.5 text-sm font-semibold shadow-sm ring-1 ring-inset ring-gray-300;
    }

    @media (max-width: 768px) {

      /* Adjust for medium devices */
      .tab-titles:before {
        left: 0;
        transform: translateX(-0%);
        width: 50%;
        /* Reduced width for medium devices */
      }

      #applicationsListbse li {
        background: white;
      }

      #applicationsListnse li {
        background: white;
      }
    }

    #tab1:checked~.tab-titles:before {
      left: 0%;
    }

    #tab2:checked~.tab-titles:before {
      left: 50%;
    }

    .shimmer-effect {
      background: linear-gradient(90deg,
          #f0f0f0 25%,
          #e0e0e0 50%,
          #f0f0f0 75%);
      background-size: 400px 100%;
      animation: shimmer 1.5s infinite;
    }

    /* desktop view */
    @media (min-width: 769px) {
      .tab-titles:before {
        left: 0;
        width: 50%;
        /* If 3 tabs, adjust for your layout */
        transform: translateX(0%);
      }

      #tab1:checked~.tab-titles:before {
        left: 0%;
      }

      #tab2:checked~.tab-titles:before {
        left: 50%;
      }

      #applicationsListbse li {
        background: white;
      }

      #applicationsListnse li {
        background: white;
      }

    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

</head>

<body class="notranslate">

  <!-- Desktop Navbar -->
  <div class="hidden md:flex items-center justify-between px-6 py-4 desktopView bg-blue-600  fixed top-0 w-full z-20">

    <!-- Logo and Title -->
    <div class="flex flex-col items-center bg-white p-1 rounded-lg">
      <img src="images/logo.png" alt="Acumen IPO" class="h-10 w-full object-cover">
    </div>

    <!-- Logout Icon -->
    <div class="flex items-center space-x-4">
      <p class="text-md font-medium text-white">IPO's</p>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24"
        stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
      </svg>
    </div>
  </div>

  <!-- mobile view navbar -->
  <div class="md:hidden block bg-blue-600 relative h-[100px] max-w-4xl mx-auto">
    <div class="flex justify-center items-center text-center">
      <div class="w-screen">
        <div class="mx-auto my-4 mb-20 rounded-md text-white font-bold">
          <nav class="absolute top-2 w-full">
            <div class="grid grid-cols-12 my-4">
              <div class="col-span-2 flex justify-start px-5 items-center">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6">
                  <path fill-rule="evenodd"
                    d="M11.03 3.97a.75.75 0 0 1 0 1.06l-6.22 6.22H21a.75.75 0 0 1 0 1.5H4.81l6.22 6.22a.75.75 0 1 1-1.06 1.06l-7.5-7.5a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 0 1 1.06 0Z"
                    clip-rule="evenodd" />
                </svg>
              </div>
              <div class="col-span-8 flex justify-start items-center text-lg font-semibold">
                IPO's
              </div>
              <div class="col-span-2 flex justify-end px-5 items-center">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2"
                  stroke="currentColor" class="h-6 w-6">
                  <path stroke-linecap="round" stroke-linejoin="round"
                    d="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z" />
                </svg>
              </div>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </div>







  <div id="contentDiv" class="flex justify-center items-center absolute top-12 left-0 right-0">
    <div class="rounded-md border mt-5 bg-white shadow-lg w-full max-w-4xl md:max-w-none min-h-screen">
      <div class="tabs px-3 py-3">
        <input type="radio" id="tab1" name="tab" checked />
        <input type="radio" id="tab2" name="tab" />

        <!--  md:sticky md:top-20 md:z-10 md:bg-white -->
        <div class="tab-titles">
          <label for="tab1" class="tab mx-4">Open & Upcoming</label>
          <label for="tab2" class="tab mx-4 ml-5">Your Application</label>
        </div>

        <div class="tab-content">
          <div class="bg-gray-100 h-2"></div>
          <div class="content md:bg-gray-50" id="content1">
            <h2 class="text-lg font-bold pt-4 md:ml-8">
              Open IPO's
              <span
                class="mx-2 inline-flex items-center rounded-full bg-red-500 px-1.5 py-0.5 text-xs font-medium text-white"
                id="countSpan"></span>
            </h2>
            <div class="mx-auto">
              <div class="my-2" id="shimmer">
                <div class="bg-gray-50 rounded-md border border-gray-200 p-2 my-4">
                  <div class="grid grid-cols-12">
                    <div class="col-span-2">
                      <div class="bg-gray-500 rounded-lg animate-pulse shimmer-effect my-2"
                        style="width: 60px; height: 50px"></div>
                    </div>
                    <div class="col-span-8">
                      <div class="bg-gray-500 rounded-lg animate-pulse shimmer-effect my-2"
                        style="width: 100%; height: 10px"></div>
                      <div class="bg-gray-200 rounded-lg animate-pulse shimmer-effect my-2"
                        style="width: 50%; height: 10px"></div>
                    </div>
                  </div>
                  <div class="">
                    <div class="bg-gray-500 rounded-lg animate-pulse shimmer-effect my-2"
                      style="width: 100%; height: 10px"></div>
                    <div class="bg-gray-200 rounded-lg animate-pulse shimmer-effect my-2"
                      style="width: 100%; height: 10px"></div>
                  </div>
                  <div class="bg-gray-200 rounded-lg animate-pulse shimmer-effect my-2"
                    style="width: 100%; height: 60px"></div>
                </div>
                <div class="bg-gray-50 rounded-md border border-gray-200 p-2 my-4">
                  <div class="grid grid-cols-12">
                    <div class="col-span-2">
                      <div class="bg-gray-500 rounded-lg animate-pulse shimmer-effect my-2"
                        style="width: 60px; height: 50px"></div>
                    </div>
                    <div class="col-span-8">
                      <div class="bg-gray-500 rounded-lg animate-pulse shimmer-effect my-2"
                        style="width: 100%; height: 10px"></div>
                      <div class="bg-gray-200 rounded-lg animate-pulse shimmer-effect my-2"
                        style="width: 50%; height: 10px"></div>
                    </div>
                  </div>
                  <div class="">
                    <div class="bg-gray-500 rounded-lg animate-pulse shimmer-effect my-2"
                      style="width: 100%; height: 10px"></div>
                    <div class="bg-gray-200 rounded-lg animate-pulse shimmer-effect my-2"
                      style="width: 100%; height: 10px"></div>
                  </div>
                  <div class="bg-gray-200 rounded-lg animate-pulse shimmer-effect my-2"
                    style="width: 100%; height: 60px"></div>
                </div>
                <div class="bg-gray-50 rounded-md border border-gray-200 p-2 my-4">
                  <div class="grid grid-cols-12">
                    <div class="col-span-2">
                      <div class="bg-gray-500 rounded-lg animate-pulse shimmer-effect my-2"
                        style="width: 60px; height: 50px"></div>
                    </div>
                    <div class="col-span-8">
                      <div class="bg-gray-500 rounded-lg animate-pulse shimmer-effect my-2"
                        style="width: 100%; height: 10px"></div>
                      <div class="bg-gray-200 rounded-lg animate-pulse shimmer-effect my-2"
                        style="width: 50%; height: 10px"></div>
                    </div>
                  </div>
                  <div class="">
                    <div class="bg-gray-500 rounded-lg animate-pulse shimmer-effect my-2"
                      style="width: 100%; height: 10px"></div>
                    <div class="bg-gray-200 rounded-lg animate-pulse shimmer-effect my-2"
                      style="width: 100%; height: 10px"></div>
                  </div>
                  <div class="bg-gray-200 rounded-lg animate-pulse shimmer-effect my-2"
                    style="width: 100%; height: 60px"></div>
                </div>
              </div>
              <div class="mx-auto my-2" id="no-shimmer" style="display: none">
                <ul id="companiesContainer" role="list"
                  class="mt-6 grid grid-cols-1 gap-x-6 w-full gap-y-8 lg:grid-cols-2 xl:gap-x-8 md:px-8"></ul>
              </div>
            </div>
          </div>
          <div class="content" id="content2">
            <div id="dashboard" class="tab-content">
              <div class="content md:bg-gray-50 md:px-6 md:pb-2" id="content2">
                <h2 class="text-lg font-bold pt-4">Your Applications</h2>
                <div class="w-full p-1">
                  <button id="nseBtn" type="button" onclick="applicationActivePage('present')"
                    class="rounded-md toggle-btn bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Present</button>
                  <button id="bseBtn" type="button" onclick="applicationActivePage('past')"
                    class="rounded-md toggle-btn bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">Past</button>
                </div>

                <div class="mx-auto my-2 hidden" id="no-shimmerApplicationsnse">
                  <ul id="applicationsListnse" role="list"
                    class="mt-6 grid grid-cols-1 gap-x-6 w-full gap-y-8 lg:grid-cols-2 xl:gap-x-8">
                    <!-- Applications will be populated here -->
                  </ul>
                </div>

                <div class="mx-auto my-2 hidden " id="no-shimmerApplicationsbse">
                  <ul id="applicationsListbse" role="list"
                    class="mt-6 grid grid-cols-1 gap-x-6 w-full gap-y-8 lg:grid-cols-2 xl:gap-x-8">
                    <!-- Applications will be populated here -->
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- scroll - move top button -->
  <button id="scrollTopBtn" class="hidden fixed bottom-5 right-5 z-40 ring-1 ring-inset ring-gray-100 
         bg-blue-500 text-white rounded-full px-4 py-2 
         shadow-md shadow-gray-400 border border-gray-300 
         hover:bg-blue-700 active:border-gray-100 
         transition duration-300 outline-none focus:outline-none">
    <i class="fa-solid fa-up-long text-white"></i>
  </button>


  <!-- popup up model -->
  <div id="modalOverlay" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
    <div id="modalBox"
      class="bg-white p-6 rounded-lg shadow-lg w-full max-w-[40rem] max-h-[80vh] overflow-y-auto relative">
      <button onclick="closeModal()" class="fixed top-4 right-4 w-10 h-10 flex items-center justify-center 
         rounded-full bg-gray-200 text-gray-600 hover:bg-red-500 hover:text-white 
         shadow-lg transition duration-200 ease-in-out z-50">
        <span class="text-xl font-bold leading-none">&times;</span>
      </button>


      <!-- Modal Content -->
      <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content bg-white">
          <div class="modal-body">
            <div class="wizard8 shadow-lg border px-4 sm:px-12 md:px-16  mb-4 bg-white rounded-xl w-full">
              <div class="row justify-center">
                <div class="w-full xl:w-11/12">
                  <div class="row justify-center">
                    <!-- Left Column - Progress -->
                    <div class="w-full ">
                      <div class="checkout-progress-indicator">
                        <div class="flex justify-center px-0 space-x-4">
                          <div
                            class="step current w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center"
                            id="1">
                            <span>1</span>
                          </div>
                          <div
                            class="step w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center"
                            id="2">
                            <span>2</span>
                          </div>
                          <div
                            class="step w-8 h-8 rounded-full bg-gray-200 text-gray-600 flex items-center justify-center"
                            id="3">
                            <span>3</span>
                          </div>
                        </div>
                        <div class="border-b-0 py-4">
                          <h4 class="text-2xl font-bold">Create Account</h4>
                          <p class="text-gray-600">Apply IPO in 30 seconds</p>
                          <div class="mt-4">
                            <img class="w-full" src="images/progress1.svg" alt="progress indicator">
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Right Column - Forms -->
                    <div class="w-full ">
                      <div class="card pb-0">
                        <div class="mt-4 p-0">
                          <!-- Step 1: Login -->
                          <div class="edit-profile__body" id="1_data">
                            <form id="login">
                              <input type="hidden" class="form-input" id="rowID" name="rowID">
                              <div class="mb-4">
                                <label for="clientCode" class="block text-gray-700 mb-2">Client Code</label>
                                <input type="text"
                                  class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 uppercase"
                                  id="clientCode" name="clientCode" placeholder="Enter Clientcode" required
                                  minlength="4" maxlength="10">
                              </div>
                              <div class="mb-4 hidden" id="txtOtpTab">
                                <label for="txtOtp" class="block text-gray-700 mb-2">Enter OTP</label>
                                <input type="text"
                                  class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 uppercase"
                                  id="txtOtp" name="txtOtp" placeholder="Enter Mobile OTP" minlength="6" maxlength="6">
                              </div>

                              <label class="hidden text-red-500 normal-case" id="errorMsg"></label>

                              <div class="flex flex-wrap justify-center md:justify-end pt-5 mb-5 gap-2">
                                <button type="button" id="resendOtp" onclick="resendLoginOtp()"
                                  class="hidden bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                                  Resend OTP
                                </button>
                                <button type="submit" id="loginbtn"
                                  class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center">
                                  Login <i class="ml-2 las la-arrow-right"></i>
                                </button>
                              </div>
                              <div class="flex flex-wrap justify-center items-center pt-5 mb-3 gap-2">
                                <span class="text-gray-600">Don't Have Account</span>
                                <button type="button" id="Signupbtn" onclick="signupH()"
                                  class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center">
                                  SignUp Here <i class="ml-2 las la-arrow-right"></i>
                                </button>
                              </div>
                            </form>
                          </div>

                          <!-- Step 2: Signup Part 1 -->
                          <div class="edit-profile__body hidden" id="2_data">
                            <form id="signup-1">
                              <div class="mb-4">
                                <label for="clientName" class="block text-gray-700 mb-2">Name</label>
                                <input type="text"
                                  class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 uppercase"
                                  id="clientName" name="clientName" required maxlength="100">
                              </div>
                              <div class="mb-4">
                                <label for="clientEmailId" class="block text-gray-700 mb-2">Email</label>
                                <input type="email"
                                  class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 uppercase"
                                  id="clientEmailId" name="clientEmailId" required minlength="5" maxlength="50">
                              </div>
                              <div class="mb-4">
                                <label for="clientMobile" class="block text-gray-700 mb-2">Phone Number</label>
                                <input type="tel"
                                  class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 uppercase"
                                  id="clientMobile" name="clientMobile" minlength="10" maxlength="10" required>
                              </div>
                              <div class="mb-4">
                                <label for="clientPan" class="block text-gray-700 mb-2">PAN</label>
                                <input type="tel"
                                  class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 uppercase"
                                  id="clientPan" name="clientPan" minlength="10" maxlength="10" required>
                              </div>
                              <input type="text" hidden name="signupPage" value="signup-1">
                              <label id="errorExist" class="hidden text-red-500"></label>
                              <div class="flex flex-wrap justify-between pt-3 mb-5 gap-2">
                                <a href="#" onclick="previous('1')"
                                  class="bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300 flex items-center">
                                  <i class="las la-arrow-left mr-2"></i>Previous
                                </a>
                                <button type="submit"
                                  class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center">
                                  Next <i class="ml-2 las la-arrow-right"></i>
                                </button>
                              </div>
                            </form>
                          </div>

                          <!-- Step 3: Signup Part 2 -->
                          <div class="edit-profile__body hidden" id="3_data">
                            <form id="signup-2">
                              <div class="mb-4">
                                <label class="block text-gray-700 mb-2">DP Name</label>
                                <div class="flex space-x-4">
                                  <div class="flex items-center">
                                    <input class="mr-2" onclick="changedep(this.id)" type="radio" name="clientDPname"
                                      required checked value="CDSL" id="radio-vl01">
                                    <label for="radio-vl01" class="text-gray-700">
                                      <span>CDSL</span>
                                    </label>
                                  </div>
                                  <div class="flex items-center">
                                    <input class="mr-2" onclick="changedep(this.id)" type="radio" name="clientDPname"
                                      required value="NSDL" id="radio-vl02">
                                    <label for="radio-vl02" class="text-gray-700">
                                      <span>NSDL</span>
                                    </label>
                                  </div>
                                </div>
                              </div>
                              <div class="mb-4">
                                <label for="clientDPid" class="block text-gray-700 mb-2">Client DP ID</label>
                                <input type="text"
                                  class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 uppercase"
                                  id="clientDPid" minlength="16" maxlength="16" name="clientDPid" required
                                  placeholder="Beneficiary Id">
                              </div>
                              <input type="text" hidden name="signupPage" value="signup-2">
                              <div class="mb-4">
                                <label for="signupOtp" class="block text-gray-700 mb-2">OTP</label>
                                <input type="text"
                                  class="w-full px-4 py-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500 uppercase"
                                  id="signupOtp" name="signupOtp" minlength="6" maxlength="6" required>
                                <label for="resendSignupOtp" onclick="resendSignUpOtp()" id="resendSignupOtp"
                                  class="text-blue-600 cursor-pointer">Resend OTP</label>
                              </div>
                              <label id="errorSignupOtp" class="hidden text-red-500"></label>
                              <div class="flex flex-wrap justify-between pt-3 mb-5 gap-2">
                                <a href="#" onclick="previous('2')"
                                  class="bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300 flex items-center">
                                  <i class="las la-arrow-left mr-2"></i>Previous
                                </a>
                                <button type="submit"
                                  class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center">
                                  Submit <i class="ml-2 las la-arrow-right"></i>
                                </button>
                              </div>
                            </form>
                          </div>

                          <!-- Notes Section -->
                          <div class="mt-6">
                            <div class="font-semibold mb-2">Note :</div>
                            <ol class="list-decimal pl-5 space-y-2">
                              <li class="text-justify">
                                Bidding is possible on all trading days (Monday-Friday) between 10am and 5pm.
                              </li>
                              <li class="text-justify">
                                You have to authenticate the mandate request to block funds you receive from
                                bank. This may take from few minutes to few hours.
                              </li>
                              <li class="text-justify">
                                Bidding done on holidays and after-market hours will get executed the very next
                                trading day. Mandate request will receive only after this execution, this may
                                take from few minutes to few hours.
                              </li>
                              <li class="text-justify">
                                If you have not received the bank mandate for blocking funds even after 6 hours,
                                then you have to cancel the application and reapply.
                              </li>
                            </ol>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>



    </div>
  </div>





  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

  <script>
    const scrollTopBtn = document.getElementById('scrollTopBtn');

    function toggleScrollButton() {
      const isDesktop = window.innerWidth >= 768;
      const scrolledEnough = window.scrollY > 100;

      if (isDesktop && scrolledEnough) {
        scrollTopBtn.classList.remove('hidden');
      } else {
        scrollTopBtn.classList.add('hidden');
      }
    }

    // Scroll and Resize Listeners
    window.addEventListener('scroll', toggleScrollButton);
    window.addEventListener('resize', toggleScrollButton);

    // Scroll to Top on Click
    scrollTopBtn.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Initial check
    toggleScrollButton();
  </script>

  <script>

    const params = new URLSearchParams(window.location.search);
    const clientCode = params.get("clientcode") || '8883234632';   //


    const cleanClientCode = clientCode?.replace(/^"|"$/g, "");


    const apiUrl = "https://ipo.acumengroup.in/nse-api/api-ipo-master.php";

    const applicationApiUrl = `https://ipo.acumengroup.in/nse-api/api-client-applications.php?clientCode=${cleanClientCode}`;

    const applicationApiUrlbse = `https://ipo.acumengroup.in/api/bse/v1/ipoapp`;

    const companyList = [];

    const bseApiUrl = "https://ipo.acumengroup.in/api/bse/v1/ipolist";

    function fetchCompanies() {
      const companiesContainer = document.getElementById("companiesContainer");
      companiesContainer.innerHTML = ""; // Clear previous content

      let nseCount = 0;
      let bseCount = 0;
      let debtCount = 0;
      // First fetch NSE Data
      fetch(apiUrl)
        .then((response) => response.json())
        .then((data) => {


          // 1. NSE Mainboard (Open)
          if (Array.isArray(data.open)) {
            data.open.forEach((company) => {

              nseCount++;
              if (company.issueType === 'DEBT') {
                debtCount++;

              }

              addCompanyToContainer(company, companiesContainer, "MAINBOARD", "NSE");
            });
          }

          // 2. NSE Upcoming
          if (Array.isArray(data.upcoming)) {
            data.upcoming.forEach((company) => {
              // nseCount++;
              addCompanyToContainer(company, companiesContainer, "UPCOMING", "NSE");
            });
          }

          // After NSE, now fetch BSE Data
          return fetch(bseApiUrl);
        })
        .then((response) => response.json())
        .then((data) => {


          // 3. BSE Mainboard (Open)
          if (Array.isArray(data.metaData.open)) {
            data.metaData.open.forEach((company) => {

              bseCount++;
              if (company.issuetype === 'DEBT') {
                debtCount++;

              }
              addCompanyToContainer(company, companiesContainer, "MAINBOARD", "BSE");
            });
          }

          // 4. BSE Upcoming
          if (Array.isArray(data.metaData.upcoming)) {
            data.metaData.upcoming.forEach((company) => {
              // bseCount++;
              addCompanyToContainer(company, companiesContainer, "UPCOMING", "BSE");
            });
          }

          updateIpoCount(nseCount, bseCount, debtCount); // Update count after both NSE and BSE loaded
        })
        .catch((error) => {
          console.error("Error fetching companies:", error);
        });
    }


    async function addCompanyToContainer(company, container, type, source, index = 0) {
      if (company.issueType === 'DEBT' || company.issuetype === 'DEPT') return;

      const dummyLogo = './images/image.png';
      let logoUrl = dummyLogo;

      // Determine symbol for logo fetch
      const symbol = company.symbol || company.scripcode || company.companySymbol;

      if (symbol) {
        try {
          const res = await fetch(`https://ipo.acumengroup.in/admin/ipo-info-entry/info.php?symbol=${symbol}`);
          if (res.ok) {
            const ipoInfo = await res.json();
            if (ipoInfo.success && ipoInfo.data?.SymbolLogo) {
              logoUrl = ipoInfo.data.SymbolLogo;
            }
          }
        } catch (err) {
          console.error("Logo fetch failed:", err);
        }
      }

      const logoId = `logo-${index}-${Date.now()}`;
      const companyDiv = document.createElement("li");
      companyDiv.classList.add(
        "overflow-hidden",
        "rounded-xl",
        "border",
        "border-gray-200",
        "py-2",
        "bg-white",
        "clickable-div"
      );

      companyDiv.addEventListener("click", () => {
        sendDataToNewPage(company, "newipodetails.html", source);
      });

      companyDiv.innerHTML = `
    <div class="flex items-center gap-x-4 border-gray-900/5 py-2 px-3 cursor-pointer">
      <img id="${logoId}" src="${logoUrl}" alt="Company Logo" class="w-12 h-12 rounded-lg object-cover" />
      <div class="text-sm/6 font-medium text-gray-900">
        <span>${company.ipoName || company.companyName}</span>
        <div class="w-full flex gap-2 mt-1">
          <span class="${source === 'NSE'
          ? 'rounded-sm bg-red-500 px-1 py-0.5 text-xs font-medium text-white ring-1 ring-inset ring-red-500/20'
          : 'rounded-sm bg-indigo-50 px-1 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/10'
        }">${source}</span>

          <span class="rounded-sm bg-indigo-50 px-1 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/10">${type}</span>  

          <span class="rounded-sm bg-indigo-50 px-1 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/10">
            ${company.subType || company.issuetype || ''}
          </span>  
        </div>
      </div>
    </div>

    <dl class="-my-3 divide-y divide-gray-100 px-3 py-4 text-sm/6">
      <div class="flex justify-between gap-x-4 py-3">
        <div>
          <dt class="text-gray-500">Opens on</dt>
          <dd class="text-gray-700 font-bold">
            <time datetime="${company.biddingStartDate || company.opendate}">
              ${new Date(company.biddingStartDate || company.opendate).toLocaleDateString("en-GB", {
          day: "2-digit", month: "short", year: "numeric"
        })}
            </time>
          </dd>
        </div>
        <div>
          <dt class="text-gray-500 flex justify-end">Minimum Investment</dt>
          <dd class="text-gray-700 font-bold flex items-center justify-end">
            ${calculateMaxInvestment(
          company.minPrice || company.floorprice,
          company.lotSize || company.tradinglot
        )}
          </dd>
        </div>
      </div>

      <div class="w-full flex">
        <div class="w-full">
          <dt class="text-gray-500">Close</dt>
          <dd class="text-gray-700 font-bold">
            <time datetime="${company.biddingEndDate || company.closedate}">
              ${new Date(company.biddingEndDate || company.closedate).toLocaleDateString("en-GB", {
          day: "2-digit", month: "short", year: "numeric"
        })}
            </time>
          </dd>
        </div>
        <div class="w-full flex justify-end items-center">
          <span class="ml-2 text-gray-700 font-bold">${company.minBidQuantity || company.tradinglot} shares</span>
        </div>
      </div>

      <div class="flex justify-between gap-x-4 p-3 rounded-md bg-gray-100">
        <dt><div class="font-bold text-gray-900">Overall Subscription</div></dt>
        <dd class="font-semibold text-green-600">0.71x</dd>
      </div>
    </dl>
  `;

      container.appendChild(companyDiv);
    }


    fetchCompanies();
    function updateIpoCount(nseCount, bseCount, debtCount) {
      const totalCount = (nseCount - debtCount) + bseCount; // Calculate total count
      const countSpan = document.getElementById('countSpan'); // Select the span by ID
      countSpan.textContent = totalCount; // Update the span with the total count
    }

    const clientInfoUrl =
      `https://ipo.acumengroup.in/nse-api/api-client-info.php?clientCode=${cleanClientCode}`;
    function fetchClientInfo() {
      fetch(clientInfoUrl)
        .then((response) => response.json())
        .then((data) => {
          localStorage.setItem("clientInfo", JSON.stringify(data));

        })
        .catch((error) => {
          console.error("Error fetching client info:", error);
        });
    }

    function calculateMaxInvestment(maxPrice, lotSize) {
      const max = parseFloat(maxPrice) || 0;
      const lot = parseInt(lotSize) || 0;
      return `₹ ${(max * lot).toFixed(2)}`;
    }

    fetchClientInfo();
    fetchApplications();
    window.onload = function () {

      const urlParams = new URLSearchParams(window.location.search);
      const tab = urlParams.get('app');

      if (tab === 'yourapplication') {
        document.getElementById('tab2').checked = true;
      } else {
        document.getElementById('tab1').checked = true;
      }

      applicationActivePage('present')
      setTimeout(() => {
        document.getElementById("shimmer").style.display = "none";
        document.getElementById("no-shimmer").style.display = "block";
      }, 2000);
    };




    async function fetchApplications() {
      const nseurl = applicationApiUrl;
      const bseurl = applicationApiUrlbse;

      let applicationglobaldata = [];

      const formData = new FormData();
      formData.append("clientCode", cleanClientCode);

      try {
        // Fetch from NSE (GET)
        const nseResponse = await fetch(nseurl, {
          method: 'GET'
        });
        if (!nseResponse.ok) throw new Error('Failed to fetch NSE data');
        const nseData = await nseResponse.json();

        nseData.applications.forEach(application => {
          application.source = 'NSE';
          applicationglobaldata.push(application);
        });

        // Fetch from BSE (POST)
        const bseResponse = await fetch(bseurl, {
          method: 'POST',
          headers: {
            'Authorization': '21279C8DC0753CD1A90DEBF3C1C5CEDB8B5B77E0455EE804C9CA03BB706CD02A',
            'Cookie': 'PHPSESSID=86ikmrbq26d8cv7lbqr7r1q07u'
          },
          body: formData
        });
        if (!bseResponse.ok) throw new Error('Failed to fetch BSE data');
        const bseData = await bseResponse.json();

        // Add BSE data to global array
        bseData.metaData.forEach((application) => {
          application.source = 'BSE';
          applicationglobaldata.push(application);


        });

        applicationFilter(applicationglobaldata)


      } catch (error) {
        console.error("Error fetching applications:", error);
      }
    }


    const activeClass = "bg-blue-600 text-white";
    const inactiveClass = "bg-white text-gray-900 hover:bg-gray-50";


    function applicationActivePage(app) {
      const nseBtn = document.getElementById('nseBtn');
      const bseBtn = document.getElementById('bseBtn');

      if (app === 'present') {
        nseBtn.classList.add(...activeClass.split(' '));
        nseBtn.classList.remove(...inactiveClass.split(' '));


        bseBtn.classList.remove(...activeClass.split(' '));
        bseBtn.classList.add(...inactiveClass.split(' '));
        document.getElementById('no-shimmerApplicationsnse').classList.remove('hidden');
        document.getElementById('no-shimmerApplicationsbse').classList.add('hidden');
      } else {
        bseBtn.classList.add(...activeClass.split(' '));
        bseBtn.classList.remove(...inactiveClass.split(' '));
        nseBtn.classList.remove(...activeClass.split(' '));
        nseBtn.classList.add(...inactiveClass.split(' '));
        document.getElementById('no-shimmerApplicationsbse').classList.remove('hidden');
        document.getElementById('no-shimmerApplicationsnse').classList.add('hidden');
      }
    }


    function applicationFilter(filteredData) {
      const presentData = [];
      const pastData = [];

      // Get current date with time set to 00:00:00 for accurate comparison
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      filteredData.forEach((application) => {
        const rawDateStr = application.responseDateTime || application.requestedDateTime;
        const responseDate = new Date(rawDateStr);

        // Reset responseDate time to 00:00:00 for accurate date-only comparison
        const responseDateOnly = new Date(responseDate);
        responseDateOnly.setHours(0, 0, 0, 0);

        // Format to dd/mm/yyyy
        const day = String(responseDate.getDate()).padStart(2, '0');
        const month = String(responseDate.getMonth() + 1).padStart(2, '0');
        const year = responseDate.getFullYear();
        const formattedDate = `${day}/${month}/${year}`;

        if (responseDateOnly >= today) {
          presentData.push(application);
        } else {
          pastData.push(application);
        }
      });

      present(presentData);


      past(pastData);
    }

    const present = (data) => {
      const applicationsList = document.getElementById("applicationsListnse");
      applicationsList.innerHTML = "";

      if (data.length === 0) {
        applicationsList.innerHTML = "<li>No applications found.</li>";
        return;
      }

      data.forEach(async (application, index) => {
        let formattedDate = 'N/A';

        if (application.responseDateTime) {
          const [year, month, day] = application.responseDateTime.split(' ')[0].split('-');
          if (year && month && day) {
            formattedDate = `${day}-${month}-${year}`;
          }
        }

        // Fetch IPO info based on symbol
        let logoUrl = './images/image.png'; // default logo
        if (application.ipoSymbol) {
          try {
            const response = await fetch(`https://ipo.acumengroup.in/admin/ipo-info-entry/info.php?symbol=${application.ipoSymbol}`);
            if (response.ok) {
              const ipoInfo = await response.json();
              if (ipoInfo.success && ipoInfo.data && ipoInfo.data.SymbolLogo) {
                logoUrl = ipoInfo.data.SymbolLogo;
              }
            }
          } catch (error) {
            console.error("Error fetching IPO info:", error);
          }
        }

        const logoId = `srcval-${index}`;

        const applicationDiv = document.createElement("li");
        applicationDiv.classList.add("overflow-hidden", "rounded-xl", "border", "border-gray-200", "py-2");

        applicationDiv.addEventListener("click", () => {
          if (application.applicationStatus === "failed" || application.appReqType === "D") {
            return;
          } else {
            sendupdatedata(application, "applicationupdate.html");
          }
        });

        applicationDiv.innerHTML = `
      <div class="gap-x-4 border-gray-900/5 cursor-pointer">
        <div class="flex items-center gap-x-4 border-gray-900/5 py-2 px-3">
          <img id="${logoId}" src="${logoUrl}" alt="Company Logo" class="w-12 h-12 rounded-lg object-cover" />
          <div>
            <div class="text-sm/6 font-medium text-gray-900">${application.ipoName || "N/A"}</div>
            <span class="${application.source === 'NSE'
            ? 'rounded-sm bg-red-500 px-1 py-0.5 text-xs font-medium text-white ring-1 ring-inset ring-red-500/20'
            : 'rounded-sm bg-indigo-50 px-1 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/10'
          }">${application.source || "N/A"}</span>
            <span class="rounded-md bg-indigo-50 px-2 py-1 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/10">MAINBOARD</span>
            ${application.applicationStatus === "failed" ? `
              <span class="rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/10">Failed</span>
            ` : ''}
            ${application.appReqType === "D" ? `
              <span class="rounded-md bg-yellow-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/10">Cancelled</span>
            ` : ''}
          </div>
        </div>
        <div class="flex gap-2 w-full px-3">
          <div class="text-sm/6 font-medium w-full text-gray-900">Application No<br>${application.applicationNo || "N/A"}</div>
          <div class="text-sm/6 font-medium w-full text-gray-900 text-right">Applied Date<br>${formattedDate}</div>
        </div>
        <dl class="-my-3 divide-y divide-gray-100 px-3 py-4 text-sm/6">
          <div class="flex justify-between gap-x-4 py-3">
            <div>
              <dt class="text-gray-500">Invested</dt>
              <dd class="text-gray-700 font-bold">₹${application.totalPrice || "N/A"}</dd>
            </div>
            <div>
              <dt class="text-gray-500">Bid Price</dt>
              <dd class="text-gray-700 font-bold">₹${application.price || "N/A"}</dd>
            </div>
            <div>
              <dt class="text-gray-500">Listed On</dt>
              <dd class="text-gray-700 font-bold">
                <time datetime="${application.requestedDateTime || ""}">
                  ${application.requestedDateTime ? new Date(application.requestedDateTime).toLocaleDateString("en-GB", {
            day: "2-digit",
            month: "short",
            year: "numeric",
          }) : "N/A"}
                </time>
              </dd>
            </div>
          </div>
          <div class="flex justify-between gap-x-4 p-3 rounded-md bg-gray-100">
            <dt class="text-gray-500">
              <span class="inline-flex items-center rounded-md bg-white px-1.5 py-0.5 text-xs font-medium text-gray-600">Day 1</span>
            </dt>
            <dt>
              <div class="font-bold text-gray-900">Overall Subscription</div>
            </dt>
            <dd class="font-semibold text-green-600">0.71x</dd>
          </div>
        </dl>
      </div>
    `;

        applicationsList.appendChild(applicationDiv);
      });
    };



    const past = async (data) => {
      const applicationsList = document.getElementById("applicationsListbse");
      applicationsList.innerHTML = "";

      if (!Array.isArray(data) || data.length === 0) {
        applicationsList.innerHTML = "<li>No applications found.</li>";
        return;
      }

      for (const [index, application] of data.entries()) {
        let formattedDate = "N/A";
        if (application.responseDateTime) {
          const [year, month, day] = application.responseDateTime.split(" ")[0].split("-");
          if (year && month && day) {
            formattedDate = `${day}-${month}-${year}`;
          }
        }

        // Fetch IPO logo
        let logoUrl = './images/image.png'; // Default fallback
        if (application.ipoSymbol) {
          try {
            const response = await fetch(`https://ipo.acumengroup.in/admin/ipo-info-entry/info.php?symbol=${application.ipoSymbol}`);
            if (response.ok) {
              const ipoInfo = await response.json();
              if (ipoInfo.success && ipoInfo.data && ipoInfo.data.SymbolLogo) {
                logoUrl = ipoInfo.data.SymbolLogo;
              }
            }
          } catch (error) {
            console.error("Error fetching IPO info:", error);
          }
        }

        const logoId = `srcval-bse-${index}`;
        const listItem = document.createElement("li");
        listItem.classList.add("overflow-hidden", "rounded-xl", "border", "border-gray-200", "py-2");

        listItem.addEventListener("click", () => {
          if (application.applicationStatus !== "failed" && application.appReqType !== "D") {
            sendupdatedata(application, "applicationupdate.html");
          }
        });

        listItem.innerHTML = `
      <div class="gap-x-4 border-gray-900/5 cursor-pointer">
        <div class="flex items-center gap-x-4 border-gray-900/5 py-2 px-3">
          <img id="${logoId}" src="${logoUrl}" alt="Company Logo" class="w-12 h-12 rounded-lg object-cover" />
          <div>
            <div class="text-sm/6 font-medium text-gray-900">${application.ipoName || "N/A"}</div>
            <span class="${application.source === 'NSE'
            ? 'rounded-sm bg-red-500 px-1 py-0.5 text-xs font-medium text-white ring-1 ring-inset ring-red-500/20'
            : 'rounded-sm bg-indigo-50 px-1 py-0.5 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/10'
          }">${application.source || "N/A"}</span>
            <span class="rounded-md bg-indigo-50 px-2 py-1 text-xs font-medium text-indigo-700 ring-1 ring-inset ring-indigo-600/10">MAINBOARD</span>
            ${application.applicationStatus === "failed" ? `
              <span class="rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/10">Failed</span>` : ''}
            ${application.appReqType === "D" ? `
              <span class="rounded-md bg-yellow-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/10">Cancelled</span>` : ''}
          </div>
        </div>
        <div class="flex gap-2 w-full px-3">
          <div class="text-sm/6 font-medium w-full text-gray-900">Application No<br>${application.applicationNo || "N/A"}</div>
          <div class="text-sm/6 font-medium w-full text-gray-900 text-right">Applied Date<br>${formattedDate}</div>
        </div>
        <dl class="-my-3 divide-y divide-gray-100 px-3 py-4 text-sm/6">
          <div class="flex justify-between gap-x-4 py-3">
            <div>
              <dt class="text-gray-500">Invested</dt>
              <dd class="text-gray-700 font-bold">₹${application.totalPrice || "N/A"}</dd>
            </div>
            <div>
              <dt class="text-gray-500">Bid Price</dt>
              <dd class="text-gray-700 font-bold">₹${application.price || "N/A"}</dd>
            </div>
            <div>
              <dt class="text-gray-500">Listed On</dt>
              <dd class="text-gray-700 font-bold">
                <time datetime="${application.requestedDateTime || ""}">
                  ${application.requestedDateTime
            ? new Date(application.requestedDateTime).toLocaleDateString("en-GB", {
              day: "2-digit",
              month: "short",
              year: "numeric",
            })
            : "N/A"}
                </time>
              </dd>
            </div>
          </div>
          <div class="flex justify-between gap-x-4 p-3 rounded-md bg-gray-100">
            <dt class="text-gray-500">
              <span class="inline-flex items-center rounded-md bg-white px-1.5 py-0.5 text-xs font-medium text-gray-600">Day 1</span>
            </dt>
            <dt>
              <div class="font-bold text-gray-900">Overall Subscription</div>
            </dt>
            <dd class="font-semibold text-green-600">0.71x</dd>
          </div>
        </dl>
      </div>
    `;

        applicationsList.appendChild(listItem);
      }
    };



    function sendDataToNewPage(company, url, source) {
      alert('popup');
      modalOverlay.classList.remove('hidden');
    }

    function closeModal() {
      modalOverlay.classList.add('hidden');
    }

    // Close when clicking outside the modal box
    modalOverlay.addEventListener('click', function (e) {
      if (!modalBox.contains(e.target)) {
        closeModal();
      }
    });
    function signupH() {
      document.getElementById("1").classList.remove("current");
      document.getElementById("1").innerHTML = '<span class="las la-check"></span>';
      document.getElementById("1").classList.add("completed");
      document.getElementById("2").classList.add("current");
      document.getElementById("1_data").style.display = "none";
      document.getElementById("2_data").style.display = "block";
    }

    function previous(value) {

      var value2 = parseInt(value) + 1;
      document.getElementById(value).innerHTML = "<span>" + value + "</span>";
      document.getElementById(value).classList.add("current");
      document.getElementById(value).classList.remove("completed");
      document.getElementById(value).classList.remove("completed");


      document.getElementById(value2).classList.remove("current");

      document.getElementById(value + "_data").style.display = "block";
      document.getElementById(value2 + "_data").style.display = "none";

    }


    function movenewpage(company, url, source) {    // actual script for move to next page

      const iporequiredDetails = {
        clientCode: cleanClientCode,
        isin: company.isin,
        ipoSymbol: company.ipoSymbol || company.symbol,
        isCompanyFrom: source,

      }
      var jsonString = JSON.stringify(iporequiredDetails);
      console.log(jsonString);

      alert('sendDataToNewPage');


      var secretKey = "ipodetailsdata01"; // Choose a strong key
      var encrypted = CryptoJS.AES.encrypt(jsonString, secretKey).toString();
      var encoded = encodeURIComponent(encrypted);

      window.location.href = url + "?data=" + encoded;
    }


    function sendupdatedata(company, url) {

      const iporequiredDetails = {
        applicationNo: company.applicationNo,
        clientCode: company.clientCode,
        isin: company.isin,
        ipoSymbol: company.ipoSymbol,
        isCompanyFrom: company.source,

      }
      var jsonString = JSON.stringify(iporequiredDetails);

      alert('sendupdatedata');
      var secretKey = "ipodetailsdata01"; // Choose a strong key
      var encrypted = CryptoJS.AES.encrypt(jsonString, secretKey).toString();
      var encoded = encodeURIComponent(encrypted);

      window.location.href = url + "?data=" + encoded;

    }






  </script>
</body>

</html>